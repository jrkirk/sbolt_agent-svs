#find ids for both objects then process in svs
sp {svs-query*propose*find-relations
   (state <s> ^name svs-query
              -^relationships
              ^superstate.operator <so>)
   (<so> ^message.fields.objects <objs>)
   (<objs> ^obj <object>
           ^type <prep>)
   (<object> ^id <id> ^index <ind>)
-->
   (<s> ^operator <o>)
   (<o> ^name find-relations
        ^category svs
        ^obj <id>
        ^ind <ind>
        ^prep <prep>) 
}
sp {svs-query*apply*find-relations
   (state <s> ^name svs-query
              ^operator <o>)
   (<o> ^name find-relations)
-->
   (<s> ^operator <o> + =)
}

#sp {svs-query*propose*find-relations*results
#   (state <s> ^name svs-query
#			  ^operator <o>)
#   (<o> ^name find-relations
#        ^relationships <rels>)
#-->
#   (<s> ^relationships <rels>)
#        
#}

#sp {svs-query*describe-object
#   (state <s> ^name svs-query
#              ^relationships <rels>)
#-->
#   (<s> ^operator <o> +)
#   (<o> ^name describe-object
#        ^category object-processing)
#}
#
#sp {svs-query*describe-object*elaborate*object
#   	(state <s> ^name svs-query
#               ^operator <o> +
#               ^relationships.relations.obj <obj-id>
#               ^topstate <ts>)
#    (<o> ^name describe-object)
#    (<ts> ^object <obj>)
#    (<obj> ^id <obj-id>)
#-->
#   (<o> ^object <obj>)
#}

sp {svs-query*propose*describe-object
   (state <s> ^name svs-query
               ^relationships.relations.obj <obj-id>
              -^described <obj>
               ^topstate.object <obj>)
   (<obj> ^id <obj-id>)
-->
   (<s> ^operator <o> + =)
   (<o> ^name describe-object
        ^category svs
        ^object <obj>)
}

sp {svs-query*apply*describe-object*send-message
   (state <s> ^name svs-query
              ^relationships <r>
              ^operator <o>
              ^topstate.io.output-link <out>)
   (<o> ^name describe-object
        ^object <obj>
        ^description <desc>)
-->
   (<s> ^sent-message.<msg> <obj>)
   (<out> ^send-message <msg>)
   (<msg> ^type describe-object
          ^fields.object <desc>)
}

sp {svs-query*apply*describe-object*mark-described
   (state <s> ^name svs-query
              ^sent-message.<msg> <obj>
              ^relationships <r>
              ^operator <o>)
   (<o> ^name describe-object
        ^object <obj>
        ^description <desc>)
   (<msg> ^status complete)
-->
   (<s> ^described <obj>)
}
   
   
   
sp {svs-query*propose*complete-svs-query
   (state <s> ^name svs-query
              ^relationships <r>)
-->
   (<s> ^operator <o> +)
   (<o> ^name complete-svs-query
        ^category svs)
}


sp {prefer*describe-object*over*complete-svs-query
   (state <s> ^name svs-query
              ^relationships <r>
              ^operator <o1> +
              ^operator <o2> +)
   (<o1> ^name describe-object)
   (<o2> ^name complete-svs-query)
-->
   (<s> ^operator <o1> > <o2>)
}

sp {svs-query*apply*complete-svs-query
   (state <s> ^name svs-query
              ^relationships <r>
              ^operator.name complete-svs-query
              ^topstate.status <status>)
-->
   (<status> ^performed.action-event describe)
}

sp {svs-query*apply*complete-svs-query*found-none
   (state <s> ^name svs-query
              ^relationships <r>
             -^described
              ^operator.name complete-svs-query
              ^io.output-link <out>)
-->
   (<out> ^send-message <msg>)
   (<msg> ^type describe-object
          ^fields.object failure)
}


#sp {svs-query*describe-objects
#   (state <s> ^name svs-query
#              ^topstate <ts>
#              ^relationships.relations.obj <obj-id>)
#   (<ts> ^object <obj>)
#   (<obj> ^id <obj-id>)  
#-->
#   (<s> ^operator <o> +)
#   (<o> ^name describe-object
#        ^idd <obj-id>
#        ^category object-processing)
#}

#sp {svs-query*apply*describe-object*elaborate*object
#   	(state <s> ^name svs-query
#               ^operator <o> +
#               ^relationships.relations.obj <obj-id>
#               ^topstate <ts>)
#    (<o> ^name describe-object
#         ^idd <obj-id>)
#    (<ts> ^object <obj>)
#    (<obj> ^id <obj-id>)
#-->
#   (<s> ^operator <o> =)
#   (<o> ^object <obj>)
#}


#sp {svs-query*description-request*apply*describe-object*mark-performed
#   (state <s> ^operator <o> +
#              ^name svs-query
#              ^relationships <rels>
#              ^topstate.status <status>
#              ^topstate.io.output-link <out>)
#   (<o> ^name describe-object
#        ^description <desc>)
#-->
#   (<out> ^send-message <msg>)
#   (<msg> ^type description
#          ^fields.object <desc>)
#   (<status> ^performed.action-event describe)
#}


    

#sp {description-request*apply*describe-object*mark-performed
#   (state <s> ^operator <o> +
#              ^name svs-query
#              ^relationships <rels>
#              ^topstate.io.output-link <out>)
#   (<o> ^name describe-object
#        ^object <obj>
#        ^description <desc>)
#-->
#   (<s> ^operator <o1> + =)
#   (<s> ^proccessed <obj>)
#   (<o1> ^name complete-describe-objs
#        ^category object-processing)
#   (<out> ^send-message <msg>)
#   (<msg> ^type description
#          ^fields.object <desc>)
#}

#sp {description-request*apply*describe-object*mark-performedw4grgrtdf
#   (state <s> ^name complete-describe-objs
#              ^topstate.status <status>)
  # (<o> ^name complete-describe-objs)
#-->
#   (<status> ^performed.action-event describe)
#
#}

sp {clean*up*object1*after*svs-query
   (state <s> ^operator.name pop-segment
              ^topstate <s>
              ^obj2 <o2>)
-->
   (<s> ^obj2 <o2> -)
}

sp {clean*up*object2*after*svs-query
   (state <s> ^operator.name pop-segment
              ^topstate <s>
              ^obj1 <o1>)
-->
   (<s> ^obj1 <o1> -)
}



